{{>layout/header}}

<style>
    .join-container {
        max-width: 400px;
        margin: 60px auto;
    }
    .form-control {
        padding: 12px 15px;
        border-radius: 8px;
        background-color: #f8f9fa;
        border: 1px solid #eee;
    }
    .form-control:focus {
        background-color: #fff;
        border-color: #333;
        box-shadow: none;
    }
    .btn-join {
        padding: 12px;
        font-weight: 700;
        border-radius: 8px;
    }
</style>

<div class="container join-container">
    <div class="text-center mb-5">
        <h2 class="fw-bold">JOIN MEMBER</h2>
        <p class="text-muted small">회원가입하고 다양한 혜택을 받아보세요.</p>
    </div>

    {{#error}}
        <div class="alert alert-danger text-center p-2 mb-4 small fw-bold">
            ⚠️ {{error}}
        </div>
    {{/error}}

    <div class="card border-0 shadow-sm p-4 rounded-4 bg-white">
        <form action="/join" method="post" onsubmit="return checkPassword()">
            <div class="mb-3">
                <label class="form-label fw-bold small">이메일 (아이디)</label>
                <input type="email" name="email" class="form-control" placeholder="예: shop@2040.com" required>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold small">비밀번호</label>
                <input type="password" name="password" id="pw1" class="form-control" placeholder="비밀번호 입력" required>
            </div>

            <div class="mb-3">
                <label class="form-label fw-bold small">비밀번호 확인</label>
                <input type="password" name="passwordConfirm" id="pw2" class="form-control" placeholder="비밀번호 다시 입력" required>
                <div id="pw-msg" class="small mt-1 fw-bold"></div>
            </div>

            <div class="mb-4">
                <label class="form-label fw-bold small">이름</label>
                <input type="text" name="name" class="form-control" placeholder="이름 입력" required>
            </div>

            <div class="d-grid gap-2">
                <button type="submit" class="btn btn-dark btn-join">회원가입 완료</button>
            </div>
        </form>

        <div class="text-center mt-4">
            <span class="text-muted small">이미 계정이 있으신가요?</span>
            <a href="/login" class="text-decoration-none fw-bold text-dark ms-1">로그인하기</a>
        </div>
    </div>
</div>

{{>layout/footer}}

<script>
    const pw1 = document.getElementById('pw1');
    const pw2 = document.getElementById('pw2');
    const msg = document.getElementById('pw-msg');

    function validatePw() {
        if(pw2.value === '') {
            msg.innerText = '';
            return;
        }

        if(pw1.value !== pw2.value) {
            msg.style.color = 'red';
            msg.innerText = '비밀번호가 일치하지 않습니다.';
        } else {
            msg.style.color = 'green';
            msg.innerText = '비밀번호가 일치합니다.';
        }
    }

    pw1.addEventListener('keyup', validatePw);
    pw2.addEventListener('keyup', validatePw);

    function checkPassword() {
        if(pw1.value !== pw2.value) {
            alert('비밀번호가 일치하지 않습니다. 다시 확인해주세요.');
            pw2.focus();
            return false;
        }
        return true;
    }
</script>